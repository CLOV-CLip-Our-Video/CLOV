# TIL - 2025년 7월 24일

## 라우팅 파라미터 전달 문제 해결 (`roomCode` → `roomId`)

### 문제 상황

- `WaitingRoom.jsx`에서 `useParams()`로 `roomCode`를 가져오고 있었으나,
- 실제 라우팅 정의 (`App.jsx`)에서는 `:roomId`로 선언되어 있었음
- 이 불일치로 인해 `roomCode`는 항상 `undefined`가 되어 fallback 값 `TEST_ROOM`으로 작동함

### 원인 분석

- `useParams()`는 라우팅 경로에 명시된 변수 이름과 정확히 일치해야만 동작함
- `App.jsx`에서는 다음과 같이 되어 있었음:
  ```tsx
  <Route path="/waiting/:roomId" element={<WaitingRoom />} />
  ```
- 하지만 `WaitingRoom.jsx`에서는 다음처럼 잘못 사용되고 있었음:
  ```js
  const { roomCode } = useParams(); // ❌ 일치하지 않음
  ```

### 해결 방법

- `WaitingRoom.jsx`에서 `roomId`를 구조분해 할당한 뒤, 내부적으로 `roomCode`라는 이름으로 재지정
  ```js
  const { roomId } = useParams();
  const roomCode = roomId;
  ```

### 오늘 배운 것 정리

- `useParams()`는 라우팅 경로의 `:파라미터명`과 정확히 매칭되는 이름으로 구조분해 할당해야 한다
- 잘못된 이름을 쓰면 `undefined`가 되고, 이후 로직 (예: `navigate()`)이나 화면 출력이 오작동할 수 있다
- 라우팅 파라미터 이름은 통일된 이름으로 일관성 있게 사용하는 것이 유지보수에 유리하다

### 🛠 리팩토링 요약

| 항목                  | 변경 전                | 변경 후                               |
| --------------------- | ---------------------- | ------------------------------------- |
| 라우팅 파라미터 이름  | `roomCode`             | `roomId`                              |
| 라우팅 경로           | `:roomId`              | (변경 없음)                           |
| WaitingRoom 내부 처리 | `useParams().roomCode` | `const roomCode = useParams().roomId` |
| 결과                  | `roomCode` 정상 전달   | ✅                                    |

## 모달 배경이 보이지 않는 문제 해결 (`twMerge` + Tailwind 클래스 병합 이슈)

### 문제 상황

- `SaveModal`이 뜨는데, 모달의 뒤를 덮어야 할 어두운 배경(overlay)이 전혀 보이지 않음
- 모달 자체는 정상적으로 포털 렌더링되고 있었고, 내용도 잘 보이는 상태였음

### 원인 분석

- `Modal.jsx`에서 overlay 클래스 병합 시 `twMerge()`를 사용하고 있었음:
  ```js
  const overlayClasses = twMerge(
    "fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",
    overlayClassName
  );
  ```
- 그런데 `overlayClassName`에서 `bg-white`, `bg-opacity-0` 등의 클래스가 들어오는 경우,
  `twMerge()`가 `bg-black`과 `bg-opacity-50`을 제거함
- Tailwind에서는 `bg-black`과 `bg-opacity-50`이 분리된 CSS 속성으로 작동해야 정상적으로 반투명 검정색이 되는데,
  `twMerge()`가 병합 중 하나를 지워버리는 문제가 발생

### 해결 방법

- Tailwind 최신 문법인 `bg-black/60`을 사용하여 하나의 클래스 안에 색상과 투명도를 함께 정의함:
  ```js
  const overlayClasses = twMerge(
    "fixed inset-0 bg-black/60 flex items-center justify-center z-50 p-4",
    overlayClassName
  );
  ```
- `bg-black/60`은 `background-color: rgba(0, 0, 0, 0.6)` 으로 컴파일되며, `twMerge`에서도 안정적으로 유지됨

### 오늘 배운 것 정리

- Tailwind의 `bg-opacity-*`는 `--tw-bg-opacity`로 CSS 변수 설정만 하므로, `bg-black`과 함께 쓰지 않으면 효과 없음
- `twMerge()`는 동일 속성(`bg-*`, `bg-opacity-*`)이 충돌할 경우 뒤의 것만 남기므로 조합 순서에 따라 의도한 클래스가 사라질 수 있음
- `bg-black/60`처럼 Tailwind JIT에서 제공하는 최신 문법을 사용하면 더 안전하고 충돌도 없음
- 재사용 컴포넌트에서 `twMerge`를 쓸 때는 조심해서 사용해야 하며, 때로는 `join(' ')`이 더 안전할 수 있음

### 리팩토링 요약

| 항목           | 변경 전                                  | 변경 후                            |
| -------------- | ---------------------------------------- | ---------------------------------- |
| overlay 클래스 | `'bg-black bg-opacity-50'` + `twMerge()` | `'bg-black/60'`                    |
| 병합 방식      | `twMerge()`로 클래스 병합                | `twMerge()` 유지, 단일 클래스 사용 |
| 결과           | 회색 배경 안 보임 → 모달 위에 흰 배경만  | ✅ 정상적인 반투명 검정 배경       |
