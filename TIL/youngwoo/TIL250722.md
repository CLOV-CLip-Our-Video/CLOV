# TIL - 2025년 7월 22일

## 주제: useCamera와 useMediaStream의 역할 분리와 실전 적용 시나리오 이해

## 오늘 한 일 요약

### 1. MediaStream의 개념과 구조 명확히 이해함
- `getUserMedia()`로 얻는 `MediaStream`은 비디오 트랙과 오디오 트랙을 포함한 객체
- 이는 브라우저가 실시간으로 장치(카메라/마이크)에서 얻은 데이터를 담는 컨테이너 역할을 함
- `.getVideoTracks()`와 `.getAudioTracks()`를 통해 각각의 트랙에 접근 가능

### 2. useCamera 훅의 책임 범위 명확히 이해
- `useCamera`는 장치로부터 stream을 생성하는 역할에 집중
- `startCamera`, `stopCamera`, `toggleCamera`, `toggleMic` 등을 통해 stream을 직접 제어
- `<video>` 태그에 연결하기 위한 `videoRef`도 포함되어 있어 미리보기 중심의 훅

### 3. 왜 useMediaStream이 별도로 필요한지 인지
- WebRTC에서 stream을 다른 사용자에게 전송하거나,
- 녹화 시 `MediaRecorder`에 넘길 때에는 단순히 stream을 생성하는 것을 넘어
  - track의 상태 관리 (`enabled`)
  - stream 교체 (`replaceStream`)
  - mute/unmute 토글 등 정교한 제어가 필요함
- 이 역할은 `useCamera`가 감당하기엔 과하고, 책임을 나눠야 하므로 `useMediaStream`이라는 훅으로 분리 필요

### 4. Toast 시스템 도입 및 구조 정비
- 기존 토스트 구현을 백업하고, 새로운 toast 유틸 파일로 기능을 분리함
- `App.jsx`에 Toast 렌더링 위치를 전역으로 추가함으로써 어느 컴포넌트에서도 호출 가능하게 만듦
- 추후 모든 사용자 알림을 toast 기반으로 처리할 수 있도록 공통 시스템으로 구성
- `RoomInfo`, `useCamera` 등 기존 컴포넌트에서도 toast 호출을 위한 리팩토링 수행

## 회고

기존에는 `useCamera` 하나로 충분하다고 생각했지만,  
WebRTC, 녹화, UI 상태 제어가 얽히는 실전 상황에선  
MediaStream 자체를 추상화하고 관리하는 별도의 계층이 꼭 필요하다는 것을 처음으로 체감했다.

stream은 생성과 사용이 완전히 분리되어야 하고,  
훅은 그 책임 단위에 맞춰 구성되어야 유지보수가 쉬워진다는 인사이트를 얻었다.  
또한 오늘은 사용자 피드백 전달을 위한 **전역 알림 시스템(toast)**을 직접 설계하고 구조화함으로써  
**사용자 경험 향상 + 시스템 일관성 확보** 측면에서 실질적인 발전을 이뤄낸 날이었다.
