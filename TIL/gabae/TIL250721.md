# TIL 250721

## 오늘 한 일 : 프로젝트 관련
- Redis 기반 Canvas 상태 저장 구조 설계 및 구현
    - 캔버스 상태 전체는 Hash 구조로 Redis에 저장
    - 상태 조회(GET)와 상태 동기화(PUT) API 구현

- Swagger 문서화 작업
    - 캔버스 상태 API에 @Operation, @Schema 적용해 명세 추가
    - SwaggerConfig.java작성
    - Swagger 버전 호환 문제(springdoc-openapi) 해결 후 정상 출력 확인
        - java.lang.NoSuchMethodError:'void org.springframework.web.method.ControllerAdviceBean.<init>(java.lang.Object)'
        - Spring Web 관련 클래스 중 하나가 버전이 섞여서 클래스 로딩 시 JVM이 잘못된 클래스 버전을 로딩
        - implementation 'org.springdoc:springdoc-openapi-starter-webmvc-ui:2.7.0'으로 버전업하니까 해결됨

- Canvas 테스트 코드 작성 완료

- RedisTemplate 관련 설정
    - RedisTemplate<String, Object> : 범용 템플릿
    - RedisTemplate<String, CanvasStateDto.BackgroundDto> : 배경 정보 전용 템플릿

## 오늘 배운 것, 고민
### RedisTemplate을 나누는 이유와 기준
- RedisTemplate<String, Object> 하나로 대부분의 데이터 처리 가능하지만,
- JSON 직렬화된 객체를 다시 DTO로 변환할 때 타입 정보 손실 또는 ClassCastException 위험 존재
- 그래서 특정 타입만 저장하는 경우에는 전용 RedisTemplate을 사용하는 게 안전함
    - 예) canvas:{roomCode}:background → RedisTemplate<String, CanvasStateDto.BackgroundDto>

- 하지만, 모든 데이터마다 전용 RedisTemplate을 만들 필요는 없다
    - 예: 방 참여자 목록 room:{roomCode}:participants에서 clientId: nickname처럼
    - Key, Field, Value가 모두 문자열인 경우에는 전용 템플릿 없이도 충분
- 이럴 땐 RedisTemplate<String, Object> 또는 RedisTemplate<String, String>, 혹은 StringRedisTemplate만으로도 처리 가능

- 실제 프로젝트에서의 기준
    - 다양한 타입 저장 필요	RedisTemplate<String, Object>
    - 특정 DTO 전용 저장소	RedisTemplate<String, DTO>
    - 문자열만 사용하는 경우	StringRedisTemplate 또는 RedisTemplate<String, String>

### 취업 특강
- 하반기에 프젝+취준 같이대비
- 산업 동향 파악 -> 신문(네이버 비추, pdf로 읽기) 매경..
- 이번 하반기때 데이터 쌓아놓기!!

## 내일 할 일
- 방 참여자 목록 불러오기
- Redis Pub/Sub + WebSocket 실시간 동기화 구현
    - 프론트에서 WebSocket만 붙이면 바로 실시간 연결/동기화 작동 가능 상태로 만들기
- WebRTC 연결용 시그널링 서버(WebSocket) 구현